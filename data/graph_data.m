% This scipt is used for the post-processing of data obtained by manual
% extraction od datapoints with the website www.graphreader.com/v2.
% In particular it is necessary to interpolate the upper and lower pressure
% coefficients values at the same query points and calculate the respective
% differences. Successively all the curves are saved in the data.mat file
% that is then used by all other functions for plotting.


close all
clear 
clc

% Cl-alphas curves for different ride heights
cl04=[-3,-2,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19;0.0498,0.2009,0.3333,0.4644,0.597,0.7297,0.8385,0.9468,1.0517,1.1558,1.241,1.3257,1.4,1.4723,1.5155,1.5579,1.5871,1.6162,1.6281,1.6388,1.6366,1.6317,1.5885];
cl06=[-3,-2,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19;0.1009,0.2304,0.3528,0.4752,0.596,0.7169,0.8189,0.9206,1.0199,1.1191,1.2097,1.3003,1.3711,1.4417,1.5081,1.5709,1.5898,1.6088,1.6287,1.6467,1.6296,1.6124,1.5884];
cl08=[-3,-2,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19;0.1242,0.2465,0.3601,0.4737,0.5866,0.6996,0.8025,0.9052,1.0037,1.1019,1.1935,1.2851,1.3747,1.4631,1.5206,1.5759,1.6032,1.6304,1.6437,1.6557,1.6447,1.6338,1.6229];
cl1=[-4,-3,-2,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19;-0.0081,0.1192,0.2465,0.3608,0.4752,0.591,0.7067,0.8103,0.9138,1.0165,1.1191,1.2108,1.3022,1.3774,1.4523,1.5231,1.5939,1.6344,1.674,1.6961,1.7165,1.7059,1.6954,1.6611];
clinf=[-4,-3,-2,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19;0,0.1249,0.2422,0.3638,0.4849,0.5923,0.6997,0.8037,0.908,1.0238,1.1389,1.236,1.333,1.4258,1.5185,1.6005,1.6824,1.7422,1.7984,1.8263,1.8362,1.8056,1.7711,1.6983];


% Pressure coefficient curves (upper and lower surfaces) for angles of
% attack 4, 8, 16, 18 (those present in the paper)
cpinflow4 = [0	-0.0397
            0.0065	0.8118
            0.0108	0.7033
            0.0194	0.5823
            0.0258	0.457
            0.0441	0.3235
            0.0742	0.2191
            0.1097	0.1816
            0.1731	0.169
            0.2925	0.1816
            0.4108	0.1816
            0.5312	0.1732
            0.6667	0.1732
            0.8054	0.1732
            0.9194	0.1649
            1	0.1565]';

cpinfup4 = [0	-0.0397
            0.0032	-0.649
            0.0075	-1.0623
            0.0108	-1.1082
            0.014	-1.1541
            0.0172	-1.1917
            0.029	-1.2209
            0.0473	-1.2417
            0.0624	-1.2417
            0.0914	-1.2501
            0.1333	-1.2376
            0.1828	-1.2042
            0.2258	-1.175
            0.2871	-1.1165
            0.371	-0.9788
            0.4441	-0.8285
            0.5688	-0.6282
            0.7054	-0.432
            0.8882	-0.0981
            1.0049	0.1565]';

cpinflow8 = [0.0024	-0.9065
            0.0041	-0.3111
            0.0065	0.3645
            0.0106	1.0401
            0.0228	0.9771
            0.0326	0.8683
            0.0554	0.6908
            0.0839	0.5649
            0.127	0.4676
            0.1678	0.4332
            0.2394	0.3817
            0.3241	0.3473
            0.4055	0.3244
            0.5049	0.2844
            0.5782	0.2729
            0.6694	0.2557
            0.7695	0.2328
            0.8567	0.2099
            0.9324	0.1813
            0.9976	0.1126
            1	0.124]';

cpinfup8 = [0.0024	-0.9065
            0.0033	-3.0076
            0.0057	-3.1164
            0.0147	-2.9447
            0.0179	-2.813
            0.0277	-2.5496
            0.035	-2.4294
            0.0472	-2.2805
            0.066	-2.1031
            0.1059	-1.9141
            0.1824	-1.6794
            0.3037	-1.3874
            0.4072	-1.1011
            0.535	-0.8034
            0.6515	-0.563
            0.7883	-0.2996
            0.9169	-0.0134
            0.9862	0.1011
            1	0.124]';

cpinflow16 = [0.001	-4.3922
            0.0136	0.2092
            0.023	0.8023
            0.0607	1.018
            0.1016	0.8382
            0.1707	0.7124
            0.2534	0.6046
            0.333	0.5327
            0.4335	0.4428
            0.5393	0.3889
            0.6377	0.335
            0.8063	0.2271
            0.9162	0.1193
            0.9791	0.0114
            1	-0.1503]';

cpinfup16 = [0.001	-4.3922
            0.0021	-9.2451
            0.0084	-7.4657
            0.0188	-5.884
            0.0387	-4.4461
            0.0723	-3.4755
            0.1215	-2.7925
            0.2178	-2.0915
            0.3183	-1.5882
            0.4565	-0.9951
            0.6115	-0.5098
            0.7236	-0.2941
            0.8178	-0.2402
            0.9204	-0.2042
            0.9613	-0.1683
            1	-0.1503]';

cpinflow18 = [0	-5.0071
            0.0073	-1.2429
            0.022	0.4149
            0.0419	0.844
            0.0639	0.922
            0.1058	0.8245
            0.1602	0.7074
            0.2429	0.6099
            0.3298	0.5319
            0.4157	0.4539
            0.5497	0.3759
            0.689	0.2589
            0.8241	0.1613
            0.9497	-0.0727
            1.001	-0.2872]';

cpinfup18 = [0	-5.0071
            0.001	-10.273
            0.0084	-7.4255
            0.0272	-5.0851
            0.0534	-3.6809
            0.0838	-2.9982
            0.1508	-2.1596
            0.1969	-1.7695
            0.2817	-1.1259
            0.3675	-0.6773
            0.4723	-0.5213
            0.6356	-0.4238
            0.799	-0.4238
            0.9613	-0.3848
            1.001	-0.2872]';

% Build interpolants and functions required for Thin Airfoil Theory and
% Potential Flow

% Interpolation points
n = 100;
x = linspace(0, 1, n);

% Interpolation method
method = "linear";

% Interpolate lower surface
cpinflow4 = interp1(cpinflow4(1, :), cpinflow4(2, :), x, method);
cpinflow8 = interp1(cpinflow8(1, :), cpinflow8(2, :), x, method);
cpinflow16 = interp1(cpinflow16(1, :), cpinflow16(2, :), x, method);
cpinflow18 = interp1(cpinflow18(1, :), cpinflow18(2, :), x , method);

% Interpolate upper surface
cpinfup4 = interp1(cpinfup4(1, :), cpinfup4(2, :), x, method);
cpinfup8 = interp1(cpinfup8(1, :), cpinfup8(2, :), x, method);
cpinfup16 = interp1(cpinfup16(1, :), cpinfup16(2, :), x, method);
cpinfup18 = interp1(cpinfup18(1, :), cpinfup18(2, :), x , method);

% Differential pressure coefficients
DCp_4 =  [x; cpinflow4-cpinfup4];
DCp_8 =  [x; cpinflow8-cpinfup8];
DCp_16 = [x; cpinflow16-cpinfup16];
DCp_18 = [x; cpinflow18-cpinfup18];

% Simple plot as sanity check
plot(DCp_4(1, :), DCp_4(2, :))
hold on
plot(DCp_8(1, :), DCp_8(2, :))
plot(DCp_16(1, :), DCp_16(2, :))
plot(DCp_18(1, :), DCp_18(2, :))


% Build data structure
data.DCp_4 = DCp_4;
data.DCp_8 = DCp_8;
data.DCp_16 = DCp_16;
data.DCp_18 = DCp_18;
data.cl04 = cl04;
data.cl08 = cl08;
data.cl1 = cl1;
data.clinf = clinf;

% Save data structure
save("data.mat", "data");
